
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>tl-ops-manage后台</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <script src="../lib/axios.js"></script>
    <script src="../lib/echarts.min.js"></script>
    <script src="../lib/layui/layui.js" v="layui" e="layui"></script>
    <link rel="stylesheet" type="text/css" href="../lib/layui/css/layui.css" />
    <link rel="stylesheet" type="text/css" href="../lib/layui/css/admin.css" />

</head>

<style>
    .layuiadmin-big-font{
        font-size: 28px !important;
    }
    .layui-layer {
        transition: all 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28) 0s;
    }

    .layui-layer-page .layui-layer-content {
        background: #ededed;
    }

    .layuiadmin-span-color,
    .layuiadmin-big-font {
        font-weight: bold;
    }

    .layui-table {
        word-break: break-all;
        box-shadow: 10px 3px 15px 3px rgb(0 0 0 / 5%);
    }

    .room-recent-title {
        margin-left: 10px;
        margin-top: 10px;
        font-weight: bold;
        font-size: 17px;
    }

    .room-status-svg {
        width: 15px;
        height: 15px;
        top: 2px;
        position: relative;
    }

    .layui-layer .layui-layer-page .layui-layer-tab {
        box-sizing: content-box;
    }

    .layui-layer-tab .layui-layer-title span {
        min-width: unset;
        max-width: unset;
    }

    .layui-layer-tab .layui-layer-title {
        display: inline-flex;
        width: 100%;
        padding: 0;
    }
</style>

<body>

    <div class="layui-fluid" id="tl-ops-web-console-waf-count-view"> </div>

    <script id="tl-ops-web-console-waf-count-tpl" type="text/html">
        <div class="layui-row layui-col-space15">
            <div class="layui-col-sm6 layui-col-md3">
                <div class="layui-card">
                    <div class="layui-card-header">
                        API规则WAF拦截次数
                        <span class="layui-badge layui-bg-green layuiadmin-badge">今天</span>
                    </div>
                    <div class="layui-card-body layuiadmin-card-list">
                        <p class="layuiadmin-big-font">{{d.waf_api_count_today}}次</p>
                        <p>
                            总计次数
                            <span class="layuiadmin-span-color"> {{d.waf_api_count_all}}次 </span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="layui-col-sm6 layui-col-md3">
                <div class="layui-card">
                    <div class="layui-card-header">
                        IP规则WAF拦截次数
                        <span class="layui-badge layui-bg-green layuiadmin-badge">今天</span>
                    </div>
                    <div class="layui-card-body layuiadmin-card-list">
    
                        <p class="layuiadmin-big-font">{{d.waf_ip_count_today}}次</p>
                        <p>
                            总计次数
                            <span class="layuiadmin-span-color"> {{d.waf_ip_count_all}}次 </span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="layui-col-sm6 layui-col-md3">
                <div class="layui-card">
                    <div class="layui-card-header">
                        CC规则WAF拦截次数
                        <span class="layui-badge layui-bg-green layuiadmin-badge">今天</span>
                    </div>
                    <div class="layui-card-body layuiadmin-card-list">
    
                        <p class="layuiadmin-big-font">{{d.waf_cc_count_today}}次</p>
                        <p>
                            总计次数
                            <span class="layuiadmin-span-color">{{d.waf_cc_count_all}}次 </span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="layui-col-sm6 layui-col-md3">
                <div class="layui-card">
                    <div class="layui-card-header">
                        Cookie规则WAF拦截次数
                        <span class="layui-badge layui-bg-green layuiadmin-badge">今天</span>
                    </div>
                    <div class="layui-card-body layuiadmin-card-list">
    
                        <p class="layuiadmin-big-font">{{d.waf_cookie_count_today}}次</p>
                        <p>
                            总计次数
                            <span class="layuiadmin-span-color">{{d.waf_cookie_count_all}}次 </span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="layui-col-sm6 layui-col-md3">
                <div class="layui-card">
                    <div class="layui-card-header">
                        Header规则WAF拦截次数
                        <span class="layui-badge layui-bg-green layuiadmin-badge">今天</span>
                    </div>
                    <div class="layui-card-body layuiadmin-card-list">
    
                        <p class="layuiadmin-big-font">{{d.waf_header_count_today}}次</p>
                        <p>
                            总计次数
                            <span class="layuiadmin-span-color">{{d.waf_header_count_all}}次 </span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="layui-col-sm6 layui-col-md3">
                <div class="layui-card">
                    <div class="layui-card-header">
                        Param规则WAF拦截次数
                        <span class="layui-badge layui-bg-green layuiadmin-badge">今天</span>
                    </div>
                    <div class="layui-card-body layuiadmin-card-list">
    
                        <p class="layuiadmin-big-font">{{d.waf_param_count_today}}次</p>
                        <p>
                            总计次数
                            <span class="layuiadmin-span-color">{{d.waf_param_count_all}}次 </span>
                        </p>
                    </div>
                </div>
            </div>
    
            {{#  layui.each(d.waf_count_list, function(index, waf_count){ }}
            <div class="layui-col-sm12">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-sm12">
                        <div class="room-recent-title">{{waf_count.name}}</div>
                        <table class="layui-table">
                            <thead> <tr> <th>服务-节点</th>  <th>规则ID</th> <th>规则</th>  <th>命中次数</th> <th>统计时间</th> </tr> </thead>
                            <tbody>
                                {{#  layui.each(waf_count.list, function(index, item){ }}
                                    {{#  layui.each(item.count_list, function(time, count){ }}
                                    <tr >
                                        <td><span class="layui-badge layui-bg-blue">{{item.service_name}}-{{item.node_id}}</span></td>
                                        <td>{{item.id}}</td>
                                        <td ><pre style="font-weight: bold;font-family: auto;">{{item.content}}</pre></td>
                                        <td>{{count}}</td>
                                        <td>{{time}}</td>
                                    </tr>
                                    {{#  }); }}
                                {{#  }); }}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {{#  }); }}
        </div>
    </script>

    <script src="../lib/tl_ops_web_comm.js"></script>
    <script src="tl_ops_web_console_waf_count.js"></script>
    <script>
        layui.use(['table', 'form', 'laytpl', 'layer'], tl_ops_web_console_waf_count_main);
    </script>
</body>

</html>